user www-data;
worker_processes auto;
pid	/tmp/nginx.pid;

events {
	worker_connections  1024;
}

http {

	##
	# General Settings
	##

	include	/etc/nginx/mime.types;
	default_type application/octet-stream;
	server_tokens off;
	sendfile off;
	tcp_nopush on;
	tcp_nodelay on;

	##
	# Client Settings
	##
	client_body_buffer_size 1K;
	client_header_buffer_size 1k;
  client_max_body_size 1K;
  large_client_header_buffers 2 1k;
  client_body_timeout   10;
  client_header_timeout 10;
  keepalive_timeout     5 5;
  send_timeout          10;

	##
	# Log Settings
	##

	access_log  /dev/stdout;
	error_log /dev/stdout crit;

  server {
  	server_name _;
  	listen 80;
  	index index.php;
  	root /var/www/public;

  	location / {
  	  limit_except GET HEAD POST { deny all; }
  		try_files $uri $uri.php $uri/ =404;
  	}

  	location ~ \.php$ {
  	  fastcgi_pass 127.0.0.1:9000;
      fastcgi_index index.php;
      fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
      fastcgi_split_path_info ^(.+\.php)(/.+)$;
      include	fastcgi_params;
      try_files $uri =404;
  	}

	  rewrite ^/guest/s/default /;
  }
}